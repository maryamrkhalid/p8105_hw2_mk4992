P8105 HW2 – mk4992
================
Maryam Khalid
2025-10-01

- [Problem 1 GOAL: merge pols-month.csv, unemployment.csv, and snp.csv
  into a single dataframe using the year and month as keys across
  datasets.](#problem-1-goal-merge-pols-monthcsv-unemploymentcsv-and-snpcsv-into-a-single-dataframe-using-the-year-and-month-as-keys-across-datasets)

## Problem 1 GOAL: merge pols-month.csv, unemployment.csv, and snp.csv into a single dataframe using the year and month as keys across datasets.

\#Step 1: clean the data in pols-month.csv

``` r
pols <- read_csv("data/pols-month.csv") |>
  clean_names() |> 
  separate(mon, into = c("year","month","day"), sep = "-", convert = TRUE) |> 
  mutate(
    month = month.name[month] |> tolower(),
    president = case_when(
      prez_gop == 1 ~ "gop",
      prez_dem == 1 ~ "dem",
      TRUE ~ NA_character_
    )
  ) |> 
  select(year, month, president, everything(), -prez_gop, -prez_dem, -day)

# View the cleaned dataset
pols |> slice_head(n = 10)
```

    ## # A tibble: 10 × 9
    ##     year month     president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem
    ##    <int> <chr>     <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ##  1  1947 january   dem            23      51     253      23      45     198
    ##  2  1947 february  dem            23      51     253      23      45     198
    ##  3  1947 march     dem            23      51     253      23      45     198
    ##  4  1947 april     dem            23      51     253      23      45     198
    ##  5  1947 may       dem            23      51     253      23      45     198
    ##  6  1947 june      dem            23      51     253      23      45     198
    ##  7  1947 july      dem            23      51     253      23      45     198
    ##  8  1947 august    dem            23      51     253      23      45     198
    ##  9  1947 september dem            23      51     253      23      45     198
    ## 10  1947 october   dem            23      51     253      23      45     198

\#Step 2: clean the data in snp.csv

``` r
snp <- read_csv("data/snp.csv") |>
  clean_names() |> 
  separate(date, into = c("month","day","year"), sep = "/", convert = TRUE) |> 
  mutate(
    year = if_else(year <50, 2000 + year, 1900 + year), #modifies 2-digit years into 4-digits
    month = month.name[month] |> tolower(),
  ) |>
  arrange(year, match(month, tolower(month.name))) |>
  select(year, month, close)

# View the cleaned dataset
snp |> slice_head(n = 10)
```

    ## # A tibble: 10 × 3
    ##     year month     close
    ##    <dbl> <chr>     <dbl>
    ##  1  1950 january    17.0
    ##  2  1950 february   17.2
    ##  3  1950 march      17.3
    ##  4  1950 april      18.0
    ##  5  1950 may        18.8
    ##  6  1950 june       17.7
    ##  7  1950 july       17.8
    ##  8  1950 august     18.4
    ##  9  1950 september  19.5
    ## 10  1950 october    19.5

\#Step 3: Clean the data in unemployment.csv

``` r
unemp <- read_csv("data/unemployment.csv") |>
  clean_names() |>
  pivot_longer(
    cols = -year,
    names_to  = "month",
    values_to = "unemployment_rate"
  ) |>
  mutate(
    # map jan→january, feb→february, etc.
    month = case_match(
      month,
      "jan" ~ "january",   "feb" ~ "february", "mar" ~ "march",
      "apr" ~ "april",     "may" ~ "may",      "jun" ~ "june",
      "jul" ~ "july",      "aug" ~ "august",   "sep" ~ "september",
      "oct" ~ "october",   "nov" ~ "november", "dec" ~ "december"
    ),
    # ensure numeric (percent as a number, not character)
    unemployment_rate = as.numeric(unemployment_rate)
  ) |>
  arrange(year, match(month, tolower(month.name)))

# quick peek
unemp |> slice_head(n = 12)
```

    ## # A tibble: 12 × 3
    ##     year month     unemployment_rate
    ##    <dbl> <chr>                 <dbl>
    ##  1  1948 january                 3.4
    ##  2  1948 february                3.8
    ##  3  1948 march                   4  
    ##  4  1948 april                   3.9
    ##  5  1948 may                     3.5
    ##  6  1948 june                    3.6
    ##  7  1948 july                    3.6
    ##  8  1948 august                  3.9
    ##  9  1948 september               3.8
    ## 10  1948 october                 3.7
    ## 11  1948 november                3.8
    ## 12  1948 december                4

\#Step 4: merge snp into pols, and then merge unemployment into the
result

``` r
# 1) merge S&P into pols
pols_snp <- left_join(pols, snp, by = c("year", "month"))

# 2) merge unemployment into the result
pols_snp_unemp <- left_join(pols_snp, unemp, by = c("year", "month"))

# quick sanity checks
dim(pols_snp_unemp)          # rows, cols
```

    ## [1] 822  11

``` r
sum(is.na(pols_snp_unemp$close))            # NA in S&P close? 36 months where we don't have S&P value
```

    ## [1] 36

``` r
sum(is.na(pols_snp_unemp$unemployment_rate))# NA in unemployment? 12 months where we don't have the unemployment rate
```

    ## [1] 12

``` r
pols_snp_unemp |> slice_head(n = 6)
```

    ## # A tibble: 6 × 11
    ##    year month    president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem close
    ##   <dbl> <chr>    <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <dbl>
    ## 1  1947 january  dem            23      51     253      23      45     198    NA
    ## 2  1947 february dem            23      51     253      23      45     198    NA
    ## 3  1947 march    dem            23      51     253      23      45     198    NA
    ## 4  1947 april    dem            23      51     253      23      45     198    NA
    ## 5  1947 may      dem            23      51     253      23      45     198    NA
    ## 6  1947 june     dem            23      51     253      23      45     198    NA
    ## # ℹ 1 more variable: unemployment_rate <dbl>

The ‘pols-month’ dataset contains 822 observations of 9 variables
related to the \# of federal politicians who are Democratic or
Republican at any given time (# of governors, senators, house
representatives of each party & whether the president at the time was
GOP/Dem).

The ‘snp’ dataset contains 787 observations of 2 variables related to
the S&P stock market index, giving us the date of the observation & the
closing value of the S&P stock index on that given date.

The ‘unemployment’ dataset contains 68 observations of 13 variables, in
which: the first variable ‘Year’ contains the 4-digit year in its
column, and the other variables are the months Jan through Dec. The
values below the month columns indicate the percentage of unemployment
in that column’s month in that row’s year.

Our final ‘pols_snp_unemp’ dataset allows us to track over time (by each
month-year combination): the closing S&P index value, the unemployment
rate, and the number of elected politicians of each party in office in
various federal positions. Thus, we can take a birds-eye view of the
economic and political state of the US at a given month-year in time.

\##Problem 2:

``` r
library(readxl)
tw_path <- file.path("data", "202509 Trash Wheel Collection Data.xlsx")
```

\#Step 1: Clean the datasets

``` r
library(dplyr)
library(janitor)
library(stringr)
library(readxl)

#Mr Trash Wheel
mr <- read_excel(tw_path, sheet = "Mr. Trash Wheel", skip = 1) |>
  clean_names() |>
  select(!contains("notes")) |>
  filter(!is.na(dumpster)) |>
  mutate(across(any_of("sports_balls"), ~ as.integer(round(.x)))) |>
  mutate(
    wheel = "Mr. Trash Wheel",
    year  = as.integer(year),
    month = str_to_title(as.character(month))
  )

mr |> slice_head(n = 5)
```

    ## # A tibble: 5 × 17
    ##   dumpster month  year date                weight_tons volume_cubic_yards
    ##      <dbl> <chr> <int> <dttm>                    <dbl>              <dbl>
    ## 1        1 May    2014 2014-05-16 00:00:00        4.31                 18
    ## 2        2 May    2014 2014-05-16 00:00:00        2.74                 13
    ## 3        3 May    2014 2014-05-16 00:00:00        3.45                 15
    ## 4        4 May    2014 2014-05-17 00:00:00        3.1                  15
    ## 5        5 May    2014 2014-05-17 00:00:00        4.06                 18
    ## # ℹ 11 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>, x15 <lgl>,
    ## #   x16 <lgl>, wheel <chr>

``` r
#Professor Trash Wheel
prof <- read_excel(tw_path, sheet = "Professor Trash Wheel", skip = 1) |>
  clean_names() |>
  select(!contains("notes")) |>
  filter(!is.na(dumpster)) |>
  mutate(
    across(any_of("sports_balls"), ~ as.integer(round(.x)))  # only if present
  ) |>
  mutate(
    wheel = "Professor Trash Wheel",
    year  = as.integer(year),
    month = str_to_title(as.character(month))
  )

#Gwynn Falls Trash Wheel
gwyn <- read_excel(tw_path, sheet = "Gwynns Falls Trash Wheel", skip = 1) |>
  clean_names() |>
  select(!contains("notes")) |>
  filter(!is.na(dumpster)) |>
  mutate(across(any_of("sports_balls"), ~ as.integer(round(.x)))) |>
  mutate(
    wheel = "Gwynnda",
    year  = as.integer(year),
    month = str_to_title(as.character(month))
  )

gwyn |> slice_head(n = 5)
```

    ## # A tibble: 5 × 13
    ##   dumpster month  year date                weight_tons volume_cubic_yards
    ##      <dbl> <chr> <int> <dttm>                    <dbl>              <dbl>
    ## 1        1 July   2021 2021-07-03 00:00:00        0.93                 15
    ## 2        2 July   2021 2021-07-07 00:00:00        2.26                 15
    ## 3        3 July   2021 2021-07-07 00:00:00        1.62                 15
    ## 4        4 July   2021 2021-07-16 00:00:00        1.76                 15
    ## 5        5 July   2021 2021-07-30 00:00:00        1.53                 15
    ## # ℹ 7 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, plastic_bags <dbl>, wrappers <dbl>,
    ## #   homes_powered <dbl>, wheel <chr>

\#Step 2: Combine the datasets altogether

``` r
# (Optional) quick check: do columns mostly align?
# intersect(names(mr), names(prof)) |> setdiff(names(gwyn))

trash <- bind_rows(mr, prof, gwyn) |>
  select(where(~ !all(is.na(.)))) |>
  select(
    wheel, dumpster, month, year, weight_tons, volume_cubic_yards,
    everything()
  ) |>
  arrange(wheel, year, match(month, month.name))


# sanity checks
trash |> count(wheel)
```

    ## # A tibble: 3 × 2
    ##   wheel                     n
    ##   <chr>                 <int>
    ## 1 Gwynnda                 349
    ## 2 Mr. Trash Wheel         707
    ## 3 Professor Trash Wheel   132

``` r
range(trash$year, na.rm = TRUE)
```

    ## [1] 2014 2025

``` r
trash |> slice_head(n = 5)
```

    ## # A tibble: 5 × 15
    ##   wheel  dumpster month  year weight_tons volume_cubic_yards date               
    ##   <chr>     <dbl> <chr> <int>       <dbl>              <dbl> <dttm>             
    ## 1 Gwynn…        1 July   2021        0.93                 15 2021-07-03 00:00:00
    ## 2 Gwynn…        2 July   2021        2.26                 15 2021-07-07 00:00:00
    ## 3 Gwynn…        3 July   2021        1.62                 15 2021-07-07 00:00:00
    ## 4 Gwynn…        4 July   2021        1.76                 15 2021-07-16 00:00:00
    ## 5 Gwynn…        5 July   2021        1.53                 15 2021-07-30 00:00:00
    ## # ℹ 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>

``` r
# (a) Total weight (tons) collected by Professor Trash Wheel
prof_weight_total_tons <- trash |>
  dplyr::filter(wheel == "Professor Trash Wheel") |>
  dplyr::summarise(total_tons = sum(weight_tons, na.rm = TRUE)) |>
  dplyr::pull(total_tons)

# (b) Total cigarette butts collected by Gwynnda in June 2022
gwynnda_cigs_june_2022 <- trash |>
  dplyr::filter(wheel == "Gwynnda", year == 2022, month == "June") |>
  dplyr::summarise(total_cigs = sum(cigarette_butts, na.rm = TRUE)) |>
  dplyr::pull(total_cigs)
```

After cleaning and combining the three datasets of these different trash
wheel devices, the dataset has 1188 observations (one per dumpster). Key
variables include `month`, `year`, `weight_tons`, `volume_cubic_yards`,
and item counts such as `plastic_bottles`, `polystyrene`,
`cigarette_butts`, `glass_bottles`, `plastic_bags`, `wrappers`, and
`sports_balls`.

**Professor Trash Wheel** collected a total of **282.3 tons** of trash.
**Gwynnda** collected **18,120 cigarette butts** in **June 2022**.

Note that the `echo = FALSE` parameter was added to the code chunk to
prevent printing of the R code that generated the plot.
